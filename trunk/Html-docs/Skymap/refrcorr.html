<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of refrcorr</title>
  <meta name="keywords" content="refrcorr">
  <meta name="description" content="REFRCORR - From true zenith angle to apparent zenith correcting">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- menu.html Skymap -->
<h1>refrcorr
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>REFRCORR - From true zenith angle to apparent zenith correcting</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [apze] = refrcorr(ze) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> REFRCORR - From true zenith angle to apparent zenith correcting
 for refraction in the atmosphere. This approximation is good up
 to zenith angles of about 80 degrees.
 
 Calling:
   [apze] = refrcorr(ze)
 Input: 
   ZE - zenith angle (radians).
 Output:
   APZE - apparent zenith angle (radians)
 
 REFRCORR  a _very_ simple correction function for zenith angles.
 It completly neglects the curvature of the earth, as well as 
 temperature and pressure profiles. This is a slight modification 
 of the procedure in FUNDAMENTAL ASTRONOMY by H. Karttunen, 
 P. Kroeger, H. Oja, M. Poutanen and K.J. Donner</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="moonpos.html" class="code" title="function [az,ze,apze] = moonpos(date,utc,lat,long)">moonpos</a>	MOONPOS calculates lunar azimuth, zenith and apparent zenith angles</li><li><a href="starpos2.html" class="code" title="function [az,ze,apze] = starpos2(ra,decl,date,utc,lat,long)">starpos2</a>	STARPOS2 gives the azimuth, zenith and apparent zenith angles</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [apze] = refrcorr(ze)</a>
0002 <span class="comment">% REFRCORR - From true zenith angle to apparent zenith correcting</span>
0003 <span class="comment">% for refraction in the atmosphere. This approximation is good up</span>
0004 <span class="comment">% to zenith angles of about 80 degrees.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% Calling:</span>
0007 <span class="comment">%   [apze] = refrcorr(ze)</span>
0008 <span class="comment">% Input:</span>
0009 <span class="comment">%   ZE - zenith angle (radians).</span>
0010 <span class="comment">% Output:</span>
0011 <span class="comment">%   APZE - apparent zenith angle (radians)</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% REFRCORR  a _very_ simple correction function for zenith angles.</span>
0014 <span class="comment">% It completly neglects the curvature of the earth, as well as</span>
0015 <span class="comment">% temperature and pressure profiles. This is a slight modification</span>
0016 <span class="comment">% of the procedure in FUNDAMENTAL ASTRONOMY by H. Karttunen,</span>
0017 <span class="comment">% P. Kroeger, H. Oja, M. Poutanen and K.J. Donner</span>
0018 
0019 
0020 <span class="comment">%   Copyright ï¿½ 19970907 Bjorn Gustavsson, &lt;bjorn.gustavsson@irf.se&gt;</span>
0021 <span class="comment">%   This is free software, licensed under GNU GPL version 2 or later</span>
0022 
0023 n0 = 1+2.8119e-4;
0024 apze = max( ze - ( 1 - 1/n0 ) * tan( ze ) , ze - .01 );</pre></div>
<hr><address>Generated on Sat 09-Feb-2013 12:20:36 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>