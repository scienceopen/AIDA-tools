<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of mysubplot</title>
  <meta name="keywords" content="mysubplot">
  <meta name="description" content="MYSUBPLOT Create axes in tiled positions.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- menu.html tools -->
<h1>mysubplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>MYSUBPLOT Create axes in tiled positions.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function theAxis = mysubplot(nrows, ncols, thisPlot) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">MYSUBPLOT Create axes in tiled positions.
   MYSUBPLOT(m,n,p), or MySUBPLOT(mnp), breaks the Figure window into
   an m-by-n matrix of small axes, selects the p-th axes for 
   for the current plot, and returns the axis handle.  The axes 
   are counted along the top row of the Figure window, then the
   second row, etc.  For example,
 
       MYSUBPLOT(2,1,1), PLOT(income)
       MYSUBPLOT(2,1,2), PLOT(outgo)
 
   plots income on the top half of the window and outgo on the
   bottom half.
 
   MYSUBPLOT(m,n,p), if the axis already exists, makes it current.
   MYSUBPLOT(H), where H is an axis handle, is another way of making
   an axis current for subsequent plotting commands.

   MYSUBPLOT('position',[left bottom width height]) creates an
   axis at the specified position in normalized coordinates (in 
   in the range from 0.0 to 1.0).

   If a MYSUBPLOT specification causes a new axis to overlap an
   existing axis, the existing axis is deleted.  For example,
   the statement MySUBPLOT(1,1,1) deletes all existing smaller
   axes in the Figure window and creates a new full-figure axis.

   MYSUBPLOT makes the subplots thighter with smaller gap inbetween.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../ALIS/AVOK/alis_img_overview.html" class="code" title="function [scrhndl] = alis_img_overview(ov_filename,f_filename,PO,print_or_what)">alis_img_overview</a>	ALIS_IMG_OVERVIEW - make ALIS data overview-plots by scanning OVERVIEW-files and INDEX-files</li><li><a href="../ALIS/AVOK/alis_overview.html" class="code" title="function [M,filters,Times,I_minmax] = alis_overview(files,POs,OPS)">alis_overview</a>	ALIS_OVERVIEW - Overviews of alis data, movie or image-mosaics</li><li><a href="../ALIS/AVOK/alis_overviewmovie.html" class="code" title="function OK = alis_overviewmovie(moviename,Filenames,POs,mOpts)">alis_overviewmovie</a>	ALIS_OVERVIEWMOVIE - Makes movies of images in files</li><li><a href="../Fits_tools/interference_rem.html" class="code" title="function img_out = interference_rem(img_in,type,method,nr_readout_regs)">interference_rem</a>	INTERFERENCE_REM - manual interference identification (and reduction)</li><li><a href="../Fits_tools/interference_rem_man.html" class="code" title="function img_out = interference_rem_man(img_in,type,method,nr_readout_regs)">interference_rem_man</a>	INTERFERENCE_REM_MAN - manual interference identification (and reduction)</li><li><a href="../Imgtools/genqt_statfilt.html" class="code" title="function [J,res] = genqt_statfilt(I,alpha,fK,OPS)">genqt_statfilt</a>	genqt_statfilt - Filtering until regional residues are statisticaly acceptable</li><li><a href="../Tomography/tomo_steps.html" class="code" title="function [Vem,stns] = tomo_steps(Vem,stns,tomo_ops,nr_laps)">tomo_steps</a>	TOMO_STEPS - tomographic itterative step(s).</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function theAxis = mysubplot(nrows, ncols, thisPlot)</a>
0002 <span class="comment">%MYSUBPLOT Create axes in tiled positions.</span>
0003 <span class="comment">%   MYSUBPLOT(m,n,p), or MySUBPLOT(mnp), breaks the Figure window into</span>
0004 <span class="comment">%   an m-by-n matrix of small axes, selects the p-th axes for</span>
0005 <span class="comment">%   for the current plot, and returns the axis handle.  The axes</span>
0006 <span class="comment">%   are counted along the top row of the Figure window, then the</span>
0007 <span class="comment">%   second row, etc.  For example,</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%       MYSUBPLOT(2,1,1), PLOT(income)</span>
0010 <span class="comment">%       MYSUBPLOT(2,1,2), PLOT(outgo)</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%   plots income on the top half of the window and outgo on the</span>
0013 <span class="comment">%   bottom half.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%   MYSUBPLOT(m,n,p), if the axis already exists, makes it current.</span>
0016 <span class="comment">%   MYSUBPLOT(H), where H is an axis handle, is another way of making</span>
0017 <span class="comment">%   an axis current for subsequent plotting commands.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%   MYSUBPLOT('position',[left bottom width height]) creates an</span>
0020 <span class="comment">%   axis at the specified position in normalized coordinates (in</span>
0021 <span class="comment">%   in the range from 0.0 to 1.0).</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   If a MYSUBPLOT specification causes a new axis to overlap an</span>
0024 <span class="comment">%   existing axis, the existing axis is deleted.  For example,</span>
0025 <span class="comment">%   the statement MySUBPLOT(1,1,1) deletes all existing smaller</span>
0026 <span class="comment">%   axes in the Figure window and creates a new full-figure axis.</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   MYSUBPLOT makes the subplots thighter with smaller gap inbetween.</span>
0029 
0030 <span class="comment">% we will kill all overlapping siblings if we encounter the mnp</span>
0031 <span class="comment">% specifier, else we won't bother to check:</span>
0032 narg = nargin;
0033 kill_siblings = 0;
0034 create_axis = 1;
0035 delay_destroy = 0;
0036 tol = sqrt(eps);
0037 <span class="keyword">if</span> narg ~= 3 <span class="comment">% make compatible with 3.5, i.e. subplot == subplot(111)</span>
0038   error(<span class="string">'Wrong number of arguments'</span>)
0039 <span class="keyword">end</span>
0040 
0041 <span class="comment">%check for encoded format</span>
0042 handle = <span class="string">''</span>;
0043 position = <span class="string">''</span>;
0044 
0045 kill_siblings = 1;
0046 
0047 <span class="comment">% if we recovered an identifier earlier, use it:</span>
0048 <span class="keyword">if</span>(~isempty(handle))
0049   
0050   set(get(0,<span class="string">'CurrentFigure'</span>),<span class="string">'CurrentAxes'</span>,handle);
0051   
0052 <span class="keyword">elseif</span>(isempty(position))
0053   <span class="comment">% if we haven't recovered position yet, generate it from mnp info:</span>
0054   <span class="keyword">if</span> (min(thisPlot) &lt; 1)
0055     error(<span class="string">'Illegal plot number.'</span>)
0056   <span class="keyword">else</span>
0057     <span class="comment">% This is the percent offset from the subplot grid of the plotbox.</span>
0058     PERC_OFFSET_L = 0.07;
0059     PERC_OFFSET_R = 0.085;
0060     PERC_OFFSET_B = PERC_OFFSET_L;
0061     PERC_OFFSET_T = PERC_OFFSET_R;
0062     <span class="keyword">if</span> nrows &gt; 2
0063       PERC_OFFSET_T = 0.9*PERC_OFFSET_T;
0064       PERC_OFFSET_B = 0.9*PERC_OFFSET_B;
0065     <span class="keyword">end</span>
0066     <span class="keyword">if</span> ncols &gt; 2
0067       PERC_OFFSET_L = 0.9*PERC_OFFSET_L;
0068       PERC_OFFSET_R = 0.9*PERC_OFFSET_R;
0069     <span class="keyword">end</span>
0070     
0071     row = (nrows-1) -fix((thisPlot-1)/ncols);
0072     col = rem (thisPlot-1, ncols);
0073 
0074     <span class="comment">% For this to work the default axes position must be in normalized coordinates</span>
0075     <span class="keyword">if</span> ~strcmp(get(gcf,<span class="string">'defaultaxesunits'</span>),<span class="string">'normalized'</span>)
0076       warning(<span class="string">'DefaultAxesUnits not normalized.'</span>)
0077       tmp = axes;
0078       set(axes,<span class="string">'units'</span>,<span class="string">'normalized'</span>)
0079       def_pos = get(tmp,<span class="string">'position'</span>);
0080       delete(tmp)
0081     <span class="keyword">else</span>
0082       def_pos = get(gcf,<span class="string">'DefaultAxesPosition'</span>)+[-.05 -.05 +.1 +.05];
0083     <span class="keyword">end</span>
0084     col_offset = def_pos(3)*(PERC_OFFSET_L+PERC_OFFSET_R)/ <span class="keyword">...</span>
0085     (ncols-PERC_OFFSET_L-PERC_OFFSET_R);
0086     row_offset = def_pos(4)*(PERC_OFFSET_B+PERC_OFFSET_T)/ <span class="keyword">...</span>
0087     (nrows-PERC_OFFSET_B-PERC_OFFSET_T);
0088     totalwidth = def_pos(3) + col_offset;
0089     totalheight = def_pos(4) + row_offset;
0090     width = totalwidth/ncols*(max(col)-min(col)+1)-col_offset;
0091     height = totalheight/nrows*(max(row)-min(row)+1)-row_offset;
0092     position = [def_pos(1)+min(col)*totalwidth/ncols <span class="keyword">...</span>
0093         def_pos(2)+min(row)*totalheight/nrows <span class="keyword">...</span>
0094         width height];
0095     <span class="keyword">if</span> width &lt;= 0.5*totalwidth/ncols
0096       position(1) = def_pos(1)+min(col)*(def_pos(3)/ncols);
0097       position(3) = 0.7*(def_pos(3)/ncols)*(max(col)-min(col)+1);
0098     <span class="keyword">end</span>
0099     <span class="keyword">if</span> height &lt;= 0.5*totalheight/nrows
0100       position(2) = def_pos(2)+min(row)*(def_pos(4)/nrows);
0101       position(4) = 0.7*(def_pos(4)/nrows)*(max(row)-min(row)+1);
0102     <span class="keyword">end</span>
0103   <span class="keyword">end</span>
0104 <span class="keyword">end</span>
0105 
0106 <span class="comment">% kill overlapping siblings if mnp specifier was used:</span>
0107 nextstate = get(gcf,<span class="string">'nextplot'</span>);
0108 <span class="keyword">if</span> strncmp(nextstate,<span class="string">'replace'</span>,7), nextstate = <span class="string">'add'</span>; <span class="keyword">end</span>
0109 <span class="keyword">if</span>(kill_siblings)
0110   <span class="keyword">if</span> delay_destroy
0111     <span class="keyword">if</span> nargout
0112       error(<span class="string">'Function called with too many output arguments'</span>)
0113     <span class="keyword">else</span>
0114       set(gcf,<span class="string">'NextPlot'</span>,<span class="string">'replace'</span>); <span class="keyword">return</span>,
0115     <span class="keyword">end</span>
0116   <span class="keyword">end</span>
0117   sibs = get(gcf, <span class="string">'Children'</span>);
0118   got_one = 0;
0119   <span class="keyword">for</span> i = 1:length(sibs)
0120     <span class="keyword">if</span>(strcmp(get(sibs(i),<span class="string">'Type'</span>),<span class="string">'axes'</span>))
0121       units = get(sibs(i),<span class="string">'Units'</span>);
0122       set(sibs(i),<span class="string">'Units'</span>,<span class="string">'normalized'</span>)
0123       sibpos = get(sibs(i),<span class="string">'Position'</span>);
0124       set(sibs(i),<span class="string">'Units'</span>,units);
0125       intersect = 1;
0126       <span class="keyword">if</span>(     (position(1) &gt;= sibpos(1) + sibpos(3)-tol) | <span class="keyword">...</span>
0127           (sibpos(1) &gt;= position(1) + position(3)-tol) | <span class="keyword">...</span>
0128           (position(2) &gt;= sibpos(2) + sibpos(4)-tol) | <span class="keyword">...</span>
0129           (sibpos(2) &gt;= position(2) + position(4)-tol))
0130     intersect = 0;
0131       <span class="keyword">end</span>
0132       <span class="keyword">if</span> intersect
0133     <span class="keyword">if</span> got_one | any(abs(sibpos - position) &gt; tol)
0134       delete(sibs(i));
0135     <span class="keyword">else</span>
0136       got_one = 1;
0137       set(gcf,<span class="string">'CurrentAxes'</span>,sibs(i));
0138       <span class="keyword">if</span> strcmp(nextstate,<span class="string">'new'</span>)
0139         create_axis = 1;
0140       <span class="keyword">else</span>
0141         create_axis = 0;
0142       <span class="keyword">end</span>
0143     <span class="keyword">end</span>
0144       <span class="keyword">end</span>
0145     <span class="keyword">end</span>
0146   <span class="keyword">end</span>
0147   set(gcf,<span class="string">'NextPlot'</span>,nextstate);
0148 <span class="keyword">end</span>
0149 
0150 <span class="comment">% create the axis:</span>
0151 <span class="keyword">if</span> create_axis
0152   <span class="keyword">if</span> strcmp(nextstate,<span class="string">'new'</span>), figure, <span class="keyword">end</span>
0153   ax = axes(<span class="string">'units'</span>,<span class="string">'normal'</span>,<span class="string">'Position'</span>, position);
0154   set(ax,<span class="string">'units'</span>,get(gcf,<span class="string">'defaultaxesunits'</span>))
0155 <span class="keyword">else</span> 
0156   ax = gca; 
0157 <span class="keyword">end</span>
0158 
0159 
0160 <span class="comment">% return identifier, if requested:</span>
0161 <span class="keyword">if</span>(nargout &gt; 0)
0162   theAxis = ax;
0163 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 09-Feb-2013 12:20:36 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>